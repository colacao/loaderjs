/*from tccdn minify at 2015-12-31 0:15:32,file：/touch/weixin/train/js/public/autoComplete/0.0.1/autoComplete.js*/
!function(){function a(){var e=b.attr("hl-cls");clearTimeout(c),b.removeClass(e).removeAttr("hl-cls"),b=null,d.off("touchend touchmove touchcancel",a)}var b,c,d=$(document);$.fn.highlight=function(e,f){return this.each(function(){var g=$(this);g.css({"-webkit-tap-highlight-color":"rgba(255,255,255,0)"}).off("touchstart.hl"),e&&g.on("touchstart.hl",function(h){var i;b=f?(i=$(h.target).closest(f,this))&&i.length&&i:g,b&&(b.attr("hl-cls",e),c=setTimeout(function(){b.addClass(e)},100),d.on("touchend touchmove touchcancel",a))})})}}(),function(){function a(){return window.autoCompleteId++}function b(b){function e(a){ib&&clearTimeout(ib),ib=setTimeout(function(){if(q.ajaxObj)try{q.ajaxObj.abort()}catch(c){}q.ajaxObj=$.ajax({url:a,data:N+"="+encodeURIComponent(E.val()),type:O,dataType:P,error:function(){},success:function(a){U(a);var c=u?u(a):a;if(q.origin=E.val(),c&&c.length)h(D),f(c,E.val());else{L&&f(),L||p(v);var d=E.val();d.length>db&&(d=d.substring(0,db)+"..."),0==b.title&&w.css({display:"block"}),h('对不起，找不到：<span class="'+ab+'">'+d+"</span>"),d=null}}}),ib=null},200)}function f(a,b,c){a&&t&&t.call(E,a),B=a;for(var d=[],e=[],f=0,h=a.length;h>f;f++){var i=e.length;e[i]=a[f],(i==J-1||f==a.length-1)&&(d[d.length]=e,e=[])}g(d,b,c)}function g(a,b,c){c=c?c:0;var d,e,f;if(p(v),a[c]&&a[c].length){for(n=0;n<a[c].length;n++)a[c][n]&&(row=v.insertRow(-1),cell=row.insertCell(-1),e=T.call(row,a[c][n],n),row.className=Y,e&&(row.className+=" "+Z),d=R.call(row,a[c][n],n),d===!1?v.deleteRow(-1):cell.innerHTML=(f=V.call(row,a[c][n],n))?k(d,b):d);v.index=-1,$(".autofill_item",v).highlight("item-state-hover")}}function h(a){E.setTitle(a)}function i(a,b){var c,d,e,f,g,h,j,k,l,m,n=[],o=b;k=o.length;for(var j=0;k>j;j++){c=o[j],d=c.match,m=d.length,f=-1;for(var l=0;m>l;l++)e=d[l],Q&&(e=e.toLowerCase()),(g=e.indexOf(a))>-1&&(-1===f||f>g)&&(f=g,h=e);f>-1&&(F&&F(c,h,f),n[n.length]=c)}return!n.length&&L?(a=a.substr(0,a.length-1),""!==a&&(n=i(a,o)),n.matchFalid=!0):(n.matchLength=a.length,!n.length&&!L),n}function j(a,c){var d;Q&&(a=a.toLowerCase()),d=""===a?A:i(a,c),q.origin=a;var e=a;a.length>db&&(e=a.substring(0,db)+"..."),d.length?(G&&d.sort(G),d.matchFalid?(0==b.title&&w.css({display:"block"}),h('对不起，找不到：<span class="'+ab+'">'+e+"</span>")):h(cb&&""!=a?a+"，"+D:D),f(d,a.substr(0,d.matchLength),0)):(0==b.title&&w.css({display:"block"}),h('对不起，找不到：<span class="'+ab+'">'+e+"</span>"),L||p(v)),e=null}function k(a,b){if(I&&""!==b){var c=b?b:E.val();"\\"===c&&(c="\\\\");var d=new RegExp(c,"g"+(Q?"i":""));return a.replace(/(>|^)([^>^<]+)(<|$)/g,function(a){return a.replace(d,function(a){return'<span class="'+ab+'">'+a+"</span>"})})}return a}function l(a){if(0==b.title&&w.css({display:"block"}),a)var c=(a.target,d(a));var f,g,h=v,i=r.css("display");if(f=E.val(),""===f){if(E.show(),0===A.length)return void E.hide();j(f,A)}else E.show();if(13===c&&"none"!==i){var k=$("."+Y,h);b.submit&&b.submit(E),B[h.index]&&(q.val(S.call(k[h.index],B[h.index],h.index)),b.selectItemFn&&"function"==typeof b.selectItemFn&&b.selectItemFn(q,k[h.index])),E.hide()}else 40===c||38===c?o(c,h,q):13===c&&"none"===i?E.hide():(g=M,g?e(g):j(f,z))}function m(a,b,d){if(!a||1!==a[0].nodeType||!b||1!==b[0].nodeType)throw new Error("需要指定输入域和/或及其弹框！");var e,f=$(window).width(),g=($(window).height(),b.width()),h=b.height(),i=a.width(),j=(a.height(),b.offset());if(d&&!c(d))d.x="number"==typeof d.x?d.x:0,d.y="number"==typeof d.y?d.y:0;else var d={x:0,y:0};a.css((e=j.left)>f-j.left&&f-j.left<i?{left:j.left+g-i-d.x+"px"}:{left:j.left+d.x+"px"}),a.css({top:j.top+h+d.y+"px"})}function o(a,b,c){var d=$("."+Y,b),e=d.length-1,f=0;if(d.length)switch(d.toggleClass(_,""),a){case 40:do b.index++;while(d[b.index]&&!$(d[b.index]).hasClass(Z));b.index>e?(b.index=-1,c.val(c.origin)):($(d[b.index]).addClass(_),f=b.index,c.val(S.call(d[b.index],B[f],f)));break;case 38:do b.index--;while(d[b.index]&&!$(d[b.index]).hasClass(Z));f=b.index,-1===b.index?c.val(c.origin):b.index<-1?(b.index=e,c.val(S.call(d[b.index],B[b.index],b.index)),$(d[b.index]).addClass(_)):($(d[b.index]).addClass(_),c.val(S.call(d[b.index],B[f],f)))}}function p(a){a.index=K;for(var b=$("."+Y,a),c=b.length;c-->0;)a.deleteRow(-1)}var q,r,s,t,u,v,w,x=a(),y='<div id="autoComplete-'+x+'" class="autofill-wrap"><div class="show-title"><span class="autofill-hd-inner"></span><span class="autofill-close"></span></div><table class="autofill-tray" cellpadding="0" cellspacing="0"></table></div>',z=[],A=[],B={},C={x:0,y:0},D="输入中文/拼音",E={},F=null,G=null,H="100%",I=!0,J=999,K=0,L=!1,M="",N="val",O="GET",P="json",Q=!0,R=function(){},S=function(){},T=function(){return!0},U=function(){},V=function(){return!0},W=!1,X="",Y="autofill_item",Z="enableListRow",_="autofill-hover",ab="autofill-hili",bb=!1,cb=!1,db=10,eb=!0,fb="body",gb=!1,hb=!1;if(q=b.input?$(b.input):null,!q[0])throw new Error("The relevant element does not exist");fb=$(b.content?b.content:fb),r=$(y).appendTo(fb),s=$(".autofill-hd-inner",r),w=$(".show-title",r),v=$(".autofill-tray",r)[0],C.x=void 0!==b.offsetX?b.offsetX:0,C.y=void 0!==b.offsetY?b.offsetY:0,u="function"==typeof b.processAjaxDataFn?b.processAjaxDataFn:null,R="function"==typeof b.itemPrintFn?b.itemPrintFn:null,"string"==typeof b.title&&$.trim(b.title).length&&(D=b.title,s.html(b.title)),"string"==typeof b.theme&&$.trim(b.theme).length&&(X=b.theme,r.addClass(b.theme)),"string"==typeof b.itemClass&&$.trim(b.itemClass).length&&(Y=b.itemClass),"string"==typeof b.highlightClass&&$.trim(b.highlightClass).length&&(ab=b.highlightClass),"function"==typeof b.ajaxFn&&(U=b.ajaxFn),H=b.width?b.width:H,t=b.processPrintDataFn?b.processPrintDataFn:t,F=b.preSortFn?b.preSortFn:F,J=b.max?b.max:J,G=b.sortFn?b.sortFn:G,L=b.keepListOnNoResult?b.keepListOnNoResult:L,M=b.requestUrl?b.requestUrl:M,O=b.requestType?b.requestType:O,P=b.dataType?b.dataType:P,R=b.itemPrintFn?b.itemPrintFn:R,T=b.itemEnableFn?b.itemEnableFn:T,S=b.itemValueFn?b.itemValueFn:S,z=b.localData?b.localData:z,A=b.defaultData?b.defaultData:A,V=b.itemHighlightFn?b.itemHighlightFn:V,_=b.chooseClass?b.chooseClass:_,hb=b.showClosebtn===!0?!0:!1,$(".autofill-close",r).css({display:hb?"block":"none"}),cb=b.showUserInput?b.showUserInput:cb,H&&r.css({width:H+"px"}),db=b.maxOverFlowNum?b.maxOverFlowNum:db,N=b.requestValName?b.requestValName:N,r.needClose=b.needClose?b.needClose:gb,bb=b.needPositionWrap?!0:bb,bb&&m(r,q,C),r.css({display:"none"});var ib;return q.on("keyup",l),q.on("input",l),q.on("click focus",function(){0!==A.length&&E.show()}),r.on("click",function(a){var c,d,e=a.target,f=v;for(d=$("."+Y,f);null!==e;){if(c=$(e),c.hasClass(Y)){d.each(function(a,g){return g===e&&$(e).hasClass(Z)?(d.toggleClass(_,""),c.addClass(_),f.index=a,q.val(S.call(d[f.index],B[f.index],f.index)),b.selectItemFn&&"function"==typeof b.selectItemFn&&b.selectItemFn(q,d[f.index]),!1):void 0}),E.hide();break}e=e.parentNode}}),hb&&$(".autofill-close",r).on("click",function(){E.hide()}),q.on("mousedown",function(){W=!0}),q.on("mouseup",function(){W=!1}),r.on("mousedown",function(){W=!0}),r.on("mouseup",function(){W=!1}),q.on("blur",function(){setTimeout(function(){W||(E.hide(),W=!1)},0)}),$(window).on("resize orientationchange",function(){E.resetPosition()}),E.macth=function(a){a?j(E.val(),a):j(E.val(),z)},E.hide=function(){r.needClose&&r.css({display:"none"})},E.show=function(){"none"===r.css("display")&&(r.css({display:"block"}),E.resetPosition()),eb===!0&&0!==A.length?(b.title!==!1&&E.setTitle(D),f(A,"",0),eb=!1):A.reset&&(f(A,"",0),b.title===!1&&E.setTitle(""))},E.setTitle=function(a){s.html(a)},E.resetDefaultData=function(a){A=a?a:[],A.reset=!0},E.val=function(a){return void 0===a?$.trim(q.val()):void q.val(a)},E.resetPosition=function(){bb&&m(r,q,C)},E.requestUrl=function(a){"string"==typeof a&&(M=a)},E.localData=z,E.resetlocalData=function(a){z=a},E}function c(a){for(var b in a)return!1;return!0}function d(a){return a=event,a.which?a.which:a.keyCode}window.autoCompleteId=window.autoCompleteId||1,$.autoComplete=function(a){return new b(a)},$.fn.autoComplete=function(a){return a.input=this,new b(a)}}();
